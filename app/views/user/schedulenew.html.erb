<!-- dual listbox -->
<script src="http://code.jquery.com/jquery-latest.js"></script>
<!-- end dual listbox -->

<!-- jlistbox -->
<!-- kaynak : http://www.senamion.com/blog/jlistbox_demo.html -->
<link rel="stylesheet" href="/stylesheets/jquery.jListbox.css" type="text/css" media="screen" />
  <script type="text/javascript" src="/javascripts/jquery.js" ></script>
  <script type="text/javascript" src="/javascripts/jquery.bgiframe.js" ></script>
  <script type="text/javascript" src="/javascripts/jquery.jListbox.js" ></script>
  <script type="text/javascript">
          $().ready(function() {
                  $("#lecturer_ids, #test").jListbox();
                  $("#showcode2").click(function() { $("#code2").toggle(); });
          });
</script>
<!-- end jlistbox -->

<div class="page">
  <h2 id="headline"><%= session[:department] %> bölümü programı öğretim görevlisi programı ayarla</h2>
  <%= form_tag({ :action => 'scheduleadd' }) do %>
    <table class="custom">
      <tr>
        <td class="label">Öğretim görevlisi</td>
        <td>
          <select id="lecturer_ids" name="lecturer_ids">
            <% @assignments.each do |k, lecturer| %>
              <option  rel="<img width='56' height='56' src='<%= lecturer.photo %>'/>" value="<%= k %>" selected>
                <%= lecturer.full_name %>
              </option>
            <% end %>
          </select>
        </td>
      </tr>
      <p id="select_lecturer_id"></p>
      <tr>
        <td class="label">Verdiği ders</td>
        <td>
          <select id="course_id" name="course_id">
          </select>
          </td>
      </tr>
      <tr>
        <td class="info" colspan=2>
          <style>
          #table {margin-left:-30px;}
          #table th{
            font-size:10px;
            padding:0em;
            border:1px solid #ddd;
          }

          #table th.courseclass{min-height:20px;height:20px;min-width:30px;width:30px;}
          #table th.class{min-height:25px;height:25px;min-width:137px;width:137px;}
          #table th.clock{min-height:20px;height:20px;min-width:60px;width:60px;}
          #table th.course{min-height:55px;height:55px;min-width:30px;width:30px;}
          </style>
          <div id="table">
            <table>
              <tr>
                <th class="clock">Saatler/Günler</th>
                <% days = {"Sunday" => "Pazartesi",
                           "Tuesday" => "Salı",
                           "Wednesday" => "Çarşamba",
                           "Thursday" => "Perşembe",
                           "Friday" => "Cuma"}
                %>
                <% days.each do |day_en, day_tr| %>
                  <th class="clock" colspan=2><%= day_tr %></th>
                <% end %>
              </tr>
              <tr>
                <th class="clock"></th>
                <% days.length.times do %>
                  <th class='courseclass'>Ders</td>
                  <th class='courseclass'>Sınıf</td>
                <% end %>
              </tr>
              <% (8..11).each do |hour| %>
              <tr>
                <th><%= time=(hour).to_s+':15'+' '+(hour+1).to_s+':00' %></th>
                <% days.each do |day_en, day_tr| %>
                  <th class="course">
                    <input type="checkbox" name="<%= day_en+(hour).to_s+'-15' %>[]"
                      id="<%= 'seçim : '+day_tr+' - '+time %>"
                      value="<%= (hour).to_s+'-15' %>" onchange="alert(this.id)"/>
                  </th>
                  <th class="class">
                    <select id="classroom_id" name="<%= day_en+(hour).to_s+'-15' %>[]" style="width:75px">
                        <option value="" selected>
                        </option>
                      <% @class.each do |k| %>
                        <option value="<%= k.id %>">
                          <%= k.name %>
                        </option>
                      <% end %>
                    </select>
                  </th>
                <% end %>
              </tr>
              <% end %>
              <%(13..22).each do |hour| %>
              <tr>
                <th><%= time=(hour).to_s+':00'+' '+(hour+1).to_s+':00' %></th>
                <% days.each do |day_en, day_tr| %>
                  <th class="course">
                    <input type="checkbox" name="<%= day_en+(hour).to_s+'-00' %>[]"
                      id="<%= 'seçim : '+day_tr+' - '+time %>"
                      value="<%= (hour).to_s+'-00' %>" onchange="alert(this.id)"/>
                  </th>
                  <th class="clock">
                    <select id="classroom_id" name="<%= day_en+(hour).to_s+'-00' %>[]" style="width:75px">
                        <option value="" selected>
                        </option>
                      <% @class.each do |k| %>
                        <option value="<%= k.id %>">
                          <%= k.name %>
                        </option>
                      <% end %>
                    </select>
                  </th>
                  <% end %>
                </tr>
              <% end %>
            </table>
          </div>
        </th>
      </tr>
      <tr>
        <td></td>
        <td>
          <input id="submit_button" type='submit' value='Kaydet'/>
        </td>
      </tr>
    </table>
  <% end %>
</div>
<!-- dual listbox -->
<script>
  $("#lecturer_ids").change(function () {
    var part = $(this).val().split('#');
    if (part[0] != "") {
      if (part[0].indexOf(';') >= 0)
        var ham_dersler = part[0].split(';');
      else
        var ham_dersler = [part[0]];

      var lecturer_id = part[1];
      var dersler = "";
      for (var i = 0; i < ham_dersler.length; i++) {
        ders = ham_dersler[i].split(',');
        if (ders[1] != undefined)
        dersler +=  "<option value='"+ ders[0] +"'>" + ders[1] + "</option>";
      }
      $("#course_id").html(dersler);
      $("#select_lecturer_id").html("<input type='hidden' id='lecturer_id' name='lecturer_id' value='" + lecturer_id + "'/>");
    }
  })
  .trigger('change');
</script>
<!-- end dual listbox -->
